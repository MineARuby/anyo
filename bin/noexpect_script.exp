#!/bin/bash
fifoa=fifo11
mkfifo ${fifoa}
exec 3<> ${fifoa}
rgx='(.*tockfish.*)\n'
rgx2='(.*cio.*)'
rgx3='(.*estmove.*)'
while IFS= read -r line
do
str="${line}"
echo "${str}"
if [[ $str =~ $rgx ]]; then
printf "uci\r" >&3
unset str
fi
if [[ $str =~ $rgx2 ]]; then
printf "position startpos moves b2b3 g8f6\rgo depth 15\r" >&3
unset str
fi
if [[ $str =~ $rgx3 ]]; then
printf "quit\r" >&3
break
fi
unset str
done < <(node "node_modules/stockfish/src/stockfish.js" <${fifoa})
echo "FINISHED"
echo "${str}"
echo "${fifoa}"
rm ${fifoa}
